(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"7UCR":function(e,n,a){"use strict";a.r(n),a.d(n,"UserModule",(function(){return $}));var t=a("Valr"),i=a("DUip"),o=a("wHSu"),r=a("TYT/"),l=a("2yus"),c=a("JOp9"),s=a("2MiI"),u=a("A27j"),d=a("6BC6"),b=a("QJY3"),f=a("qSak"),m=a("o8Qb");function g(e,n){1&e&&r.Ob(0,"app-loading-block")}var p=function(e){return["/","user","add",e]};function h(e,n){if(1&e&&(r.Tb(0,"li",9),r.Tb(1,"div",10),r.Tb(2,"b"),r.Cc(3),r.Sb(),r.Tb(4,"div",11),r.Tb(5,"div",12),r.Cc(6),r.Sb(),r.Tb(7,"div"),r.Tb(8,"small"),r.Cc(9),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(10,"div"),r.Tb(11,"small"),r.Cc(12),r.Sb(),r.Sb(),r.Sb()),2&e){var a=n.$implicit;r.kc("routerLink",r.nc(5,p,null==a?null:a.id)),r.Bb(3),r.Ec("",null==a?null:a.name," "),r.Bb(3),r.Dc(null==a?null:a.zone),r.Bb(3),r.Dc(null==a?null:a.level),r.Bb(3),r.Dc(null==a?null:a.address)}}function v(e,n){if(1&e&&(r.Tb(0,"ul"),r.Ac(1,h,13,7,"li",8),r.Sb()),2&e){var a=r.ec();r.Bb(1),r.kc("ngForOf",a.data)}}var S=function(){return["/","user","add"]},T=function(){function e(e,n){var a=this;this.rest=e,this.shared=n,this.faUser=o.m,this.faPlus=o.g,this.data=[],this.loading=!1,this.page=1,this.limit=9,this.src="",this.roundInnerHeight=function(e,n,a){return void 0===a&&(a=.02),parseInt(String(e+n))+parseInt(String(e+n))*a},this.search=function(e){a.data=[],e.length>2?(a.page=1,a.actualPage=null,a.load(["&src="+e])):(a.actualPage=null,a.page=1,a.load())},this.load=function(e){void 0===e&&(e=[]);var n=["users","?limit="+a.limit];a.page&&a.actualPage!==a.page&&!a.loading&&(n=["users?","limit="+a.limit+"&page="+a.page,""+e.join("")],a.loading=!0,a.rest.get(n.join("")).subscribe((function(e){return a.parseDate(e.data.data,e.data.next_page_url,e.data.from)}),(function(e){a.loading=!1})))},this.parseDate=function(e,n,t){void 0===e&&(e=[]),a.actualPage=t,a.loading=!1,a.page=a.shared.parsePageUrl(n),e.map((function(e){return a.data.push(e)}))}}return e.prototype.onScroll=function(){this.roundInnerHeight(window.innerHeight,window.scrollY)>parseInt(String(document.body.offsetHeight))&&this.load()},e.prototype.ngOnInit=function(){this.load()},e.\u0275fac=function(n){return new(n||e)(r.Nb(l.a),r.Nb(c.a))},e.\u0275cmp=r.Hb({type:e,selectors:[["app-list"]],hostBindings:function(e,n){1&e&&r.bc("scroll",(function(){return n.onScroll()}),!1,r.sc)},decls:11,vars:10,consts:[[3,"label","icon"],[1,"list-user","p-2","pl-3","pr-3"],[1,"text-right","mb-2"],[1,"btn","btn-outline-secondary","btn-sm",3,"routerLink"],[3,"icon"],[1,"form-group"],["autocomplete","off","type","text","id","src","placeholder","Buscar...",1,"form-control","src-input",3,"ngModel","ngModelChange"],[4,"ngIf"],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],[1,"d-flex","justify-content-between"],[1,"text-muted","text-right"],[1,"text-capitalize"]],template:function(e,n){1&e&&(r.Ob(0,"app-header",0),r.fc(1,"translate"),r.Ob(2,"app-logged-user"),r.Tb(3,"div",1),r.Tb(4,"div",2),r.Tb(5,"button",3),r.Ob(6,"fa-icon",4),r.Sb(),r.Sb(),r.Tb(7,"div",5),r.Tb(8,"input",6),r.bc("ngModelChange",(function(e){return n.src=e}))("ngModelChange",(function(e){return n.search(e)})),r.Sb(),r.Sb(),r.Ac(9,g,1,0,"app-loading-block",7),r.Ac(10,v,2,1,"ul",7),r.Sb()),2&e&&(r.kc("label",r.gc(1,7,"HEADER.USER"))("icon",n.faUser),r.Bb(5),r.kc("routerLink",r.mc(9,S)),r.Bb(1),r.kc("icon",n.faPlus),r.Bb(2),r.kc("ngModel",n.src),r.Bb(1),r.kc("ngIf",n.loading),r.Bb(1),r.kc("ngIf",!n.loading))},directives:[s.a,u.a,i.d,d.a,b.c,b.n,b.p,t.k,f.a,t.j],pipes:[m.c],styles:[".list-user[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none;font-size:.8rem;background-color:#fff}.list-user[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:1rem;margin-bottom:.5rem;border-bottom:1px solid #f4f4f4}.list-user[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:0}.src-input[_ngcontent-%COMP%]{border:0 solid #fff;border-radius:3px;font-size:.8rem;background-color:hsla(0,0%,100%,.45)}"]}),e}(),O=a("jioA"),C=a("cUzu"),k=a("hMSI"),B=a("2iZp"),M=a("zRhN"),E=a("JYfv"),y=a("YRkU");function A(e,n){if(1&e&&(r.Tb(0,"option",27),r.Cc(1),r.Sb()),2&e){var a=n.$implicit;r.kc("value",null==a?null:a.id),r.Bb(1),r.Dc(null==a?null:a.name)}}function I(e,n){if(1&e&&(r.Tb(0,"div",3),r.Tb(1,"label",24),r.Cc(2),r.fc(3,"translate"),r.Sb(),r.Tb(4,"select",25),r.Ac(5,A,2,2,"option",26),r.Sb(),r.Tb(6,"small",6),r.Cc(7),r.fc(8,"translate"),r.Sb(),r.Sb()),2&e){var a=r.ec();r.Bb(2),r.Dc(r.gc(3,3,"STAFF.FORM.INSTITUTIONS")),r.Bb(3),r.kc("ngForOf",a.institutions),r.Bb(2),r.Dc(r.gc(8,5,"STAFF.FORM.INSTITUTIONS_PLACEHOLDER"))}}function R(e,n){if(1&e&&(r.Tb(0,"option",27),r.Cc(1),r.Sb()),2&e){var a=n.$implicit;r.kc("value",null==a?null:a.value),r.Bb(1),r.Dc(null==a?null:a.name)}}function F(e,n){if(1&e&&(r.Tb(0,"div",3),r.Tb(1,"label",28),r.Cc(2),r.fc(3,"translate"),r.Sb(),r.Tb(4,"select",29),r.Ac(5,R,2,2,"option",26),r.Sb(),r.Tb(6,"small",6),r.Cc(7),r.fc(8,"translate"),r.Sb(),r.Sb()),2&e){var a=r.ec();r.Bb(2),r.Dc(r.gc(3,3,"USER.FORM.LEVEL")),r.Bb(3),r.kc("ngForOf",a.levels),r.Bb(2),r.Dc(r.gc(8,5,"USER.FORM.LEVEL_PLACEHOLDER"))}}function L(e,n){if(1&e&&(r.Tb(0,"option",27),r.Cc(1),r.Sb()),2&e){var a=n.$implicit;r.kc("value",null==a?null:a.value),r.Bb(1),r.Dc(null==a?null:a.name)}}function D(e,n){if(1&e&&(r.Tb(0,"div",3),r.Tb(1,"label",28),r.Cc(2),r.fc(3,"translate"),r.Sb(),r.Tb(4,"select",30),r.Ac(5,L,2,2,"option",26),r.Sb(),r.Tb(6,"small",6),r.Cc(7),r.fc(8,"translate"),r.Sb(),r.Sb()),2&e){var a=r.ec();r.Bb(2),r.Dc(r.gc(3,3,"USER.FORM.ZONE")),r.Bb(3),r.kc("ngForOf",a.zones),r.Bb(2),r.Dc(r.gc(8,5,"USER.FORM.ZONE_PLACEHOLDER"))}}function w(e,n){}function N(e,n){if(1&e&&r.Ob(0,"img",34),2&e){var a=r.ec().$implicit;r.kc("src",null==a?null:a.src,r.vc)}}function U(e,n){if(1&e&&r.Ob(0,"img",34),2&e){var a=r.ec().$implicit;r.kc("src",null==a?null:a.small,r.vc)}}var _=function(e){return{"image-loading":e}};function P(e,n){if(1&e){var a=r.Ub();r.Tb(0,"div",31),r.Tb(1,"span",32),r.bc("click",(function(){r.tc(a);var e=n.$implicit;return r.ec().removeImage(e)})),r.Ob(2,"fa-icon",23),r.Sb(),r.Ac(3,N,1,1,"img",33),r.Ac(4,U,1,1,"img",33),r.Sb()}if(2&e){var t=n.$implicit,i=r.ec();r.kc("ngClass",r.nc(4,_,null==t?null:t.loading)),r.Bb(2),r.kc("icon",i.faTimes),r.Bb(1),r.kc("ngIf",null==t?null:t.src),r.Bb(1),r.kc("ngIf",null==t?null:t.small)}}var x=function(){return{standalone:!0}},z=function(){function e(e,n,a,t,i,r,l,c){var s=this;this.formBuilder=e,this.rest=n,this.router=a,this.shared=t,this.http=i,this.cookie=r,this.auth=l,this.route=c,this.faUser=o.m,this.faHome=o.e,this.faDownload=o.d,this.faTrash=o.l,this.faCamera=o.a,this.faImage=o.f,this.faTimes=o.k,this.loading=!1,this.id=!1,this.images=[],this.adapter=new O.a(this.http,this.cookie),this.institutions=[],this.zones=[{name:"Castellanos",value:"castellanos"},{name:"Amen\xe1bar",value:"amen\xe1bar"},{name:"Cafferata",value:"cafferata"},{name:"Ca\xf1ada del Ucle",value:"ca\xf1ada del ucle"},{name:"Carmen",value:"carmen"},{name:"Carreras",value:"carreras"},{name:"Chapuy",value:"chapuy"},{name:"Chovet",value:"chovet"},{name:"Christophersen",value:"christophersen"},{name:"Diego de Alvear",value:"diego de alvear"},{name:"Elortondo",value:"elortondo"},{name:"Firmat",value:"firmat"},{name:"Hughes",value:"hughes"},{name:"Labordeboy",value:"labordeboy"},{name:"La Chispa",value:"la chispa"},{name:"Lazzarino",value:"lazzarino"},{name:"Maggiolo",value:"maggiolo"},{name:"Mar\xeda Teresa",value:"mar\xeda teresa"},{name:"Melincu\xe9",value:"melincu\xe9"},{name:"Miguel Torres",value:"miguel torres"},{name:"Murphy",value:"murphy"},{name:"Rufino",value:"rufino"},{name:"Sancti Spiritu",value:"sancti spiritu"},{name:"San Eduardo",value:"san eduardo"},{name:"San Francisco de Santa Fe",value:"san francisco de santa fe"},{name:"San Gregorio",value:"san gregorio"},{name:"Santa Isabel",value:"santa isabel"},{name:"Teodelina",value:"teodelina"},{name:"Venado Tuerto",value:"venado tuerto"},{name:"Villa Ca\xf1\xe1s",value:"villa ca\xf1\xe1s"},{name:"Wheelwright",value:"wheelwright"}],this.levels=[{name:"Administrador general",value:"admin",select:!1},{name:"Comuna / Municipio",value:"manager",select:!1},{name:"Usuario",value:"user",select:!1}],this.loadInstitutions=function(){s.rest.get("institutions?limit=10000").subscribe((function(e){s.institutions=e.data.data}),(function(e){}))},this.onSubmit=function(){s.loading=!0,s.form.patchValue({extra:s.itemsAsObjects,images:s.images}),s.rest[s.id?"put":"post"]("users"+(s.id?"/"+s.id:""),s.form.value).subscribe((function(e){s.loading=!1,s.modalLink(e),s.router.navigate(["/","user"])}),(function(e){s.loading=!1}))},this.modalLink=function(e){try{var n=e.data.link.split("?"),a=window.location.origin+"/#/auth/confirmed/"+e.data.id+"?";a=""+a+n.reverse().find((function(e){return!0})),s.shared.alertHtml("Compartir",'<input class="form-control"  readonly value="'+a+'">')}catch(t){return null}},this.parseUser=function(){try{s.lvl=JSON.parse(s.cookie.get("user")).level}catch(e){return null}},this.load=function(e){void 0===e&&(e=!1),s.rest.get("users/"+s.id+(e?"?export=pdf":"")).subscribe((function(e){s.itemsAsObjects=s.shared.wrapperDataExtra(e.data),s.images=e.data.images,s.form.patchValue(e.data)}),(function(e){}))},this.trash=function(){s.shared.confirm("\xbfSeguro?","","OK").then((function(e){s.rest.delete("users/"+s.id).subscribe((function(){return s.router.navigate(["/","user"])}),(function(e){}))}))},this.report=function(){s.shared.confirm("Reporte","","OK").then((function(e){s.rest.get("users/"+s.id+"?export=pdf").subscribe((function(e){window.open(e.data.url)}),(function(e){}))}))},this.addImage=function(e){s.loading=!0,s.shared.toBase64(e.file).then((function(n){s.images.push({name:e.fileName,src:n,loading:!0})}))},this.uploadImage=function(e){s.loading=!1,s.images.forEach((function(n){e.fileName===n.name&&(n.online=JSON.parse(e.fileId),n.loading=!1,n.id=n.online.id)}))},this.uploadImageFail=function(e){s.loading=!1},this.removeImage=function(e){s.images=s.images.filter((function(n){return n.id!==e.id}))}}return e.prototype.ngOnInit=function(){var e=this;this.route.params.subscribe((function(n){e.id=n.id,e.load(),e.parseUser(),e.loadInstitutions()})),this.form=this.formBuilder.group({name:["",b.u.required],email:["",[b.u.required,b.u.email]],level:["",b.u.required],zone:["",b.u.required],institutions_id:[""],extra:[""],images:[""],avatar:[""]});var n=this.auth.getUser();n&&n.zone&&this.form.patchValue({zone:n.zone}),this.form.patchValue({level:"manager"})},e.\u0275fac=function(n){return new(n||e)(r.Nb(b.e),r.Nb(l.a),r.Nb(i.c),r.Nb(c.a),r.Nb(C.a),r.Nb(k.a),r.Nb(B.a),r.Nb(i.a))},e.\u0275cmp=r.Hb({type:e,selectors:[["app-add"]],decls:54,vars:48,consts:[["label","User",3,"icon"],[1,"edit-add-user","p-2","pl-2","pr-2","ml-3","mr-3"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","form_name"],["type","text","formControlName","name","id","form_name","placeholder","",1,"form-control"],[1,"form-text","text-muted"],["for","form_email"],["type","email","formControlName","email","id","form_email","placeholder","",1,"form-control",3,"readOnly"],[3,"identifyBy","secondaryPlaceholder","displayBy","placeholder","ngModel","ngModelOptions","ngModelChange"],["class","form-group",4,"ngIf"],["itemTemplate",""],[1,"col-12","row","m-0","p-0"],["class","col-4 pl-0 pt-0 pb-1 pr-1",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-4","p-0"],[1,"customPicker",3,"adapter","itemTemplate","fileAdded","uploadSuccess","uploadFail"],[1,"dropzoneTemplate","text-center"],["size","2x",3,"icon"],[1,"d-flex"],[1,"w-75"],[1,"btn","btn-info","w-100",3,"appLoadingButton","dis","label"],[1,"w-25","pl-1"],["type","button",1,"btn","btn-danger","w-100",3,"disabled","click"],[3,"icon"],["for","form_institutions"],["formControlName","institutions_id","id","form_institutions",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","form_level"],["formControlName","level","id","form_level",1,"form-control"],["formControlName","zone","id","form_zone",1,"form-control"],[1,"col-4","pl-0","pt-0","pb-1","pr-1",3,"ngClass"],[1,"icon-close",3,"click"],["class","img-gallery","alt","",3,"src",4,"ngIf"],["alt","",1,"img-gallery",3,"src"]],template:function(e,n){if(1&e&&(r.Ob(0,"app-header",0),r.Ob(1,"app-logged-user"),r.Tb(2,"div",1),r.Tb(3,"form",2),r.bc("ngSubmit",(function(){return n.onSubmit()})),r.Tb(4,"div",3),r.Tb(5,"label",4),r.Cc(6),r.fc(7,"translate"),r.Sb(),r.Ob(8,"input",5),r.Tb(9,"small",6),r.Cc(10),r.fc(11,"translate"),r.Sb(),r.Sb(),r.Tb(12,"div",3),r.Tb(13,"label",7),r.Cc(14),r.fc(15,"translate"),r.Sb(),r.Ob(16,"input",8),r.Tb(17,"small",6),r.Cc(18),r.fc(19,"translate"),r.Sb(),r.Sb(),r.Tb(20,"div",3),r.Tb(21,"label"),r.Cc(22),r.fc(23,"translate"),r.Sb(),r.Tb(24,"tag-input",9),r.bc("ngModelChange",(function(e){return n.itemsAsObjects=e})),r.Sb(),r.Tb(25,"small",6),r.Cc(26),r.fc(27,"translate"),r.Sb(),r.Sb(),r.Ac(28,I,9,7,"div",10),r.Ac(29,F,9,7,"div",10),r.Ac(30,D,9,7,"div",10),r.Tb(31,"div",3),r.Tb(32,"label"),r.Cc(33),r.fc(34,"translate"),r.Sb(),r.Ac(35,w,0,0,"ng-template",null,11,r.Bc),r.Tb(37,"div",12),r.Ac(38,P,5,6,"div",13),r.Tb(39,"div",14),r.Tb(40,"ngx-file-picker",15),r.bc("fileAdded",(function(e){return n.addImage(e)}))("uploadSuccess",(function(e){return n.uploadImage(e)}))("uploadFail",(function(e){return n.uploadImageFail(e)})),r.Tb(41,"div",16),r.Ob(42,"fa-icon",17),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Tb(43,"small",6),r.Cc(44),r.fc(45,"translate"),r.Sb(),r.Sb(),r.Tb(46,"div",18),r.Tb(47,"div",19),r.Tb(48,"button",20),r.fc(49,"translate"),r.Cc(50," ENVIAR "),r.Sb(),r.Sb(),r.Tb(51,"div",21),r.Tb(52,"button",22),r.bc("click",(function(){return n.trash()})),r.Ob(53,"fa-icon",23),r.Sb(),r.Sb(),r.Sb(),r.Sb(),r.Sb()),2&e){var a=r.rc(36);r.kc("icon",n.faUser),r.Bb(3),r.kc("formGroup",n.form),r.Bb(3),r.Dc(r.gc(7,29,"USER.FORM.NAME")),r.Bb(4),r.Dc(r.gc(11,31,"USER.FORM.NAME_PLACEHOLDER")),r.Bb(4),r.Dc(r.gc(15,33,"USER.FORM.EMAIL")),r.Bb(2),r.kc("readOnly",n.id),r.Bb(2),r.Dc(r.gc(19,35,"USER.FORM.EMAIL_PLACEHOLDER")),r.Bb(4),r.Dc(r.gc(23,37,"USER.FORM.TAG")),r.Bb(2),r.kc("identifyBy","key")("secondaryPlaceholder","")("displayBy","value")("placeholder","")("ngModel",n.itemsAsObjects)("ngModelOptions",r.mc(47,x)),r.Bb(2),r.Dc(r.gc(27,39,"USER.FORM.TAG_PLACEHOLDER")),r.Bb(2),r.kc("ngIf","manager"===n.lvl),r.Bb(1),r.kc("ngIf","admin"===n.lvl),r.Bb(1),r.kc("ngIf",!n.form.value.zone||"admin"===n.lvl),r.Bb(3),r.Dc(r.gc(34,41,"USER.FORM.IMAGES")),r.Bb(5),r.kc("ngForOf",n.images),r.Bb(2),r.kc("adapter",n.adapter)("itemTemplate",a),r.Bb(2),r.kc("icon",n.faImage),r.Bb(2),r.Dc(r.gc(45,43,"USER.FORM.IMAGES_PLACEHOLDER")),r.Bb(4),r.kc("appLoadingButton",n.loading)("dis",!n.form.valid)("label",r.gc(49,45,"GENERAL.LOADING")),r.Bb(4),r.kc("disabled",!n.form.valid),r.Bb(1),r.kc("icon",n.faTrash)}},directives:[s.a,u.a,b.w,b.o,b.j,b.c,b.n,b.h,M.a,b.p,t.k,t.j,E.b,d.a,y.a,b.t,b.q,b.v,t.i],pipes:[m.c],styles:[".edit-add-user[_ngcontent-%COMP%]{padding:0;list-style:none;font-size:.8rem;background-color:#fff}.form-control[_ngcontent-%COMP%]{border-radius:0;font-size:.8rem;background-color:#fafafa;border:0 solid #fff;border-bottom:1px solid #ddd}input.ng-touched.ng-invalid[_ngcontent-%COMP%]{border:1px solid #ff756b}.alert-info[_ngcontent-%COMP%]{padding:.35rem;font-size:.75rem;border-radius:3px}"]}),e}(),H=[{path:"",component:T},{path:"add",component:z},{path:"add/:id",component:z}],j=function(){function e(){}return e.\u0275mod=r.Lb({type:e}),e.\u0275inj=r.Kb({factory:function(n){return new(n||e)},imports:[[i.f.forChild(H)],i.f]}),e}(),V=a("ct+p"),G=a("PCNd"),$=function(){function e(){}return e.\u0275mod=r.Lb({type:e}),e.\u0275inj=r.Kb({factory:function(n){return new(n||e)},imports:[[t.c,M.b,G.a,j,V.HomeModule,m.b,b.s,b.k,d.b,E.c]]}),e}()}}]);